<main>

    <div class="reset">

        <h3>Set a new password</h3>

        <form id="reset-password-form" action="/update-password-recovery" method="POST">

            <input id="token" type="text" name="token" hidden>

            <span>New password : </span>
            <input type="password" name="new_password" required>
            <span>Confirm new password : </span>
            <input type="password" name="confirm_password" required>


            <% if (flash.error && flash.error.length > 0) { %>
            <div class="error-message">
                <i class="fas fa-exclamation-circle"></i>
                <% if (flash.error == 'Token expired') { %>
                    Recovery link expired. <a href='/recover-password'>Try again</a> or go back to <a href="./sign-in">Home.</a><div class=""></div>                <% } else{ %>
                    <%= flash.error %>
                <% } %>
            </div>

            <% } %>



            <input class="button" id="reset-button" type="submit" value="Reset">

        </form>

    </div>
</main>



<script>

    const token = new URLSearchParams(window.location.search).get('token');
    document.getElementById('token').value = token;

</script>